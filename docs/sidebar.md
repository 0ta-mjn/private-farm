# サイドバー設計

## フェーズ1: 農業日誌・ユーザー管理機能

### 基本要件

フェーズ1では、農業日誌機能とユーザー管理機能に必要な最低限のサイドバー機能を実装する。将来のフェーズで追加される機能への拡張性も考慮した設計とする。

### 機能要件

#### 1. メインナビゲーション

- **ホーム**
  - ダッシュボードホームへのリンク (`/dashboard`)
  - アクティブ状態の視覚的表示
  - アイコン: HomeIcon

- **農業日誌**
  - 日誌一覧ページへのリンク (`/diary`)
  - アクティブ状態の視覚的表示
  - アイコン: BookIcon
  - サブアクション: 「新しい日誌を作成」ボタン (`/diary/new`)

#### 2. ユーザー・組織情報表示

- **ユーザープロフィール**
  - ユーザー名の表示
  - プロフィール設定へのリンク (`/profile`)
  - アバター画像（将来対応）

- **組織情報**
  - 組織名の表示
  - 組織設定へのリンク (`/organization/settings`)
  - 将来のメンバー管理機能への布石

#### 3. 設定・管理機能

- **設定メニュー**
  - アカウント設定 (`/settings/account`)
  - 通知設定 (`/settings/notifications`) - プレースホルダー
  - アイコン: SettingsIcon

- **ログアウト**
  - ログアウト機能の実行
  - 確認ダイアログ表示
  - アイコン: LogoutIcon

#### 4. 将来機能のプレースホルダー

以下の機能は実装せず、グレーアウト状態で表示する：

- **センサー管理**
  - 「準備中」バッジ表示
  - クリック時に「準備中」メッセージ表示
  - アイコン: SensorIcon

- **リアルタイムデータ**
  - 「準備中」バッジ表示
  - クリック時に「準備中」メッセージ表示
  - アイコン: ChartIcon

- **履歴データ**
  - 「準備中」バッジ表示
  - クリック時に「準備中」メッセージ表示
  - アイコン: HistoryIcon

### UI/UX要件

#### 1. レスポンシブ対応

- **デスクトップ (≥1024px)**
  - デフォルトで展開状態
  - 幅: 256px
  - 折りたたみボタンで最小化可能

- **タブレット (768px - 1023px)**
  - デフォルトで折りたたみ状態
  - オーバーレイ表示

- **モバイル (≤767px)**
  - ハンバーガーメニューで表示
  - 全画面オーバーレイ

#### 2. アニメーション

- **展開・折りたたみ**
  - スムーズなトランジション（300ms）
  - イージング: `ease-in-out`

- **メニュー項目のホバー**
  - 軽微なスケールアップ効果
  - 150ms のトランジション

### 技術要件

#### 1. データ構造

```typescript
interface SidebarItem {
  id: string;
  label: string;
  icon: React.ComponentType;
  href?: string;
  onClick?: () => void;
  disabled?: boolean;
  badge?: string;
  children?: SidebarItem[];
}

interface SidebarSection {
  id: string;
  title?: string;
  items: SidebarItem[];
}
```

#### 2. 状態管理

- **サイドバー開閉状態**
  - ローカルストレージに保存
  - デバイス種別ごとに記憶

- **アクティブメニュー**
  - 現在のパスから自動判定
  - Next.js の `useRouter` を使用

#### 3. アクセシビリティ

- **キーボードナビゲーション**
  - Tab キーでの順次移動
  - Enter/Space キーでの選択

- **スクリーンリーダー対応**
  - 適切な ARIA ラベル
  - セマンティックな HTML 構造

- **カラーコントラスト**
  - WCAG 2.1 AA レベル準拠
  - テキストコントラスト比 4.5:1 以上

#### 4. パフォーマンス

- **遅延読み込み**
  - アイコンの動的インポート
  - 未使用機能の Code Splitting

- **メモ化**
  - React.memo でのコンポーネント最適化
  - useMemo での計算結果キャッシュ

### 実装優先度

#### Priority 1 (必須)

- メインナビゲーション（ホーム、農業日誌）
- ユーザー情報表示
- ログアウト機能
- 基本的なレスポンシブ対応

#### Priority 2 (推奨)

- 設定メニュー
- 折りたたみ機能
- アクティブ状態表示

#### Priority 3 (任意)

- 将来機能のプレースホルダー
- アニメーション効果
- 高度なアクセシビリティ対応

### テスト要件

#### 1. 単体テスト

- メニュー項目のレンダリング
- アクティブ状態の判定
- ナビゲーション機能

#### 2. 統合テスト

- ページ遷移の確認
- ログアウト機能の動作
- レスポンシブ表示の確認

#### 3. E2E テスト

- 全メニュー項目の動作確認
- モバイル・デスクトップでの表示確認
